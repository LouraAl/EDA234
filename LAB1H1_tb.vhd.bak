LIBRARY ieee;
USE ieee.std_logic_1164.ALL;
USE ieee.numeric_std.ALL;

ENTITY LAB1H1_tb IS
END LAB1H1_tb;

ARCHITECTURE arch_LAB1H1_tb OF LAB1H1_tb IS

  COMPONENT LAB1H1 IS
    generic( 
      constant CTRL_max : natural;
      constant sec_pulse_max : natural
    );
    PORT ( 
      CLK   : in std_logic;
      RESET : in std_logic;
      SEG   : out std_logic_vector(7 downto 0);
      AN    : out STD_LOGIC_VECTOR (7 downto 0)
    );
  END COMPONENT LAB1H1;

  SIGNAL clk_tb_signal: STD_LOGIC := '1';
  SIGNAL reset_tb_signal: STD_LOGIC;
  SIGNAL seg_tb_signal: STD_LOGIC_VECTOR(7 DOWNTO 0);
  SIGNAL an_tb_signal: STD_LOGIC_VECTOR(7 DOWNTO 0);
  

BEGIN

  uut_comp:
  COMPONENT LAB1H1
    generic map (
      CTRL_max => 3,
      sec_pulse_max => 3
    )
    PORT MAP(
      CLK => clk_tb_signal,
      RESET => reset_tb_signal,
      SEG => seg_tb_signal,
      AN => an_tb_signal
    );

  reset_tb_signal <= '0',
                     '1' AFTER 320 ns;  -- Increased reset time

  clk_proc:
  PROCESS
  BEGIN
    WAIT FOR 10 ns;
    clk_tb_signal <= NOT(clk_tb_signal);
  END PROCESS clk_proc;

  test_proc:
  PROCESS
  BEGIN

    WAIT FOR 370 ns; -- 320 ns
    WAIT UNTIL an_tb_signal = "11111101";
    ASSERT (seg_tb_signal ="11000000")
    REPORT "Error: Digit 0 fail"
    SEVERITY ERROR;

    WAIT FOR 800 ns; -- 1200 ns
    WAIT UNTIL an_tb_signal = "11111101";
    ASSERT (seg_tb_signal ="11111001")
    REPORT "Error: Digit 1 fail"
    SEVERITY ERROR;

    WAIT FOR 800 ns; -- sss ns
    WAIT UNTIL an_tb_signal = "11111101";
    ASSERT (seg_tb_signal ="10100100")
    REPORT "Error: Digit 2 fail"
    SEVERITY ERROR;

    WAIT FOR 800 ns; -- sss ns
    WAIT UNTIL an_tb_signal = "11111101";
    ASSERT (seg_tb_signal ="10110000")
    REPORT "Error: Digit 3 fail"
    SEVERITY ERROR;


    WAIT FOR 800 ns; -- sss ns
    WAIT UNTIL an_tb_signal = "11111101";
    ASSERT (seg_tb_signal ="10011001")
    REPORT "Error: Digit 4 fail"
    SEVERITY ERROR;


    WAIT FOR 800 ns; -- sss ns
    WAIT UNTIL an_tb_signal = "11111101";
    ASSERT (seg_tb_signal ="10010010")
    REPORT "Error: Digit 5 fail"
    SEVERITY ERROR;


    WAIT FOR 800 ns; -- sss ns
    WAIT UNTIL an_tb_signal = "11111101";
    ASSERT (seg_tb_signal ="10000010")
    REPORT "Error: Digit 6 fail"
    SEVERITY ERROR;


    WAIT FOR 800 ns; -- sss ns
    WAIT UNTIL an_tb_signal = "11111101";
    ASSERT (seg_tb_signal ="10000010")
    REPORT "Error: Digit 6 fail"
    SEVERITY ERROR;


    WAIT FOR 800 ns; -- sss ns
    WAIT UNTIL an_tb_signal = "11111101";
    ASSERT (seg_tb_signal ="10000000")
    REPORT "Error: Digit 8 fail"
    SEVERITY ERROR;


    WAIT FOR 800 ns; -- sss ns
    WAIT UNTIL an_tb_signal = "11111101";
    ASSERT (seg_tb_signal ="10010000")
    REPORT "Error: Digit 9 fail"
    SEVERITY ERROR;

    
    WAIT FOR 10000 ns;

    REPORT "Test completed successfully!"
    SEVERITY NOTE;
WAIT;
  END PROCESS test_proc;

END arch_LAB1H1_tb;